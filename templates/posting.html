<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tailwind CSS 포스트 작성 팝업</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 커스텀 트랜지션을 위한 스타일 */
        #modal-content {
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
        }

        /* select 태그 기본 스타일링 제거 (화살표 커스텀을 위함) */
        select {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke-width='2' stroke='%236b7280' class='w-6 h-6'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' d='M19.5 8.25l-7.5 7.5-7.5-7.5' /%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1.25em;
            padding-right: 2.5rem;
            /* 화살표 아이콘 공간 확보 */
        }
        /* 유효하지 않은 select 스타일 */
        select:invalid {
            color: #9ca3af;
        }
    </style>
</head>

<body class="bg-gray-100 font-sans">

    <!-- 메인 컨텐츠 영역 -->
    <div class="min-h-screen flex flex-col items-center justify-center p-4">
        <div class="text-center">
            <h1 class="text-4xl font-bold text-gray-800 mb-4">포스팅</h1>
            <p class="text-gray-600 mb-8">아래 버튼을 눌러 포스팅을 시작하세요.</p>
            <!-- 색상 수정 -->
            <button id="open-modal-btn"
                class="bg-[#05D182] hover:bg-[#04A868] text-white font-bold py-3 px-8 rounded-lg shadow-lg transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-[#05D182] focus:ring-opacity-50">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 inline-block mr-2" fill="none"
                    viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                </svg>
                글쓰기
            </button>
        </div>
    </div>

    <!-- 팝업 모달 -->
    <div id="modal-overlay"
        class="hidden fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4 transition-opacity duration-300">
        <!-- 모달 컨텐츠 -->
        <div id="modal-content"
            class="bg-white rounded-2xl shadow-2xl w-full max-w-lg p-8 transform scale-95 opacity-0">
            <!-- 모달 헤더 -->
            <div class="flex justify-between items-center mb-6">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                         <!-- 색상 수정 -->
                        <input id="cat-study" type="radio" name="category" value="공동구매"
                            class="h-4 w-4 text-[#05D182] focus:ring-[#05D182] border-gray-300" checked>
                        <label for="cat-study" class="ml-2 block text-sm text-gray-900 cursor-pointer">공동구매</label>
                    </div>
                    <div class="flex items-center">
                         <!-- 색상 수정 -->
                        <input id="cat-project" type="radio" name="category" value="공동배달"
                            class="h-4 w-4 text-[#05D182] focus:ring-[#05D182] border-gray-300">
                        <label for="cat-project" class="ml-2 block text-sm text-gray-900 cursor-pointer">공동배달</label>
                    </div>
                </div>
                <button id="close-modal-btn-x" class="text-gray-400 hover:text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>

                <!-- 포스트 작성 폼 -->
                <form id="post-form" class="space-y-6">
                    <!-- 제목 -->
                    <div>
                        <label for="title" class="block text-sm font-medium text-gray-700 mb-1">제목</label>
                         <!-- 색상 수정 -->
                        <input type="text" id="title" name="title" placeholder="포스트 제목을 입력하세요"
                            class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#05D182] transition"
                            required>
                    </div>

                    <!-- URL -->
                    <div>
                        <label for="url" class="block text-sm font-medium text-gray-700 mb-1 transition-colors">URL</label>
                         <!-- 색상 수정 -->
                        <input type="url" id="url" name="url" placeholder="https://example.com"
                            class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#05D182] transition"
                             required>
                    </div>

                    <!-- 시간 선택 (드롭다운) -->
                    <div>
                        <label for="time" class="block text-sm font-medium text-gray-700 mb-1">시간</label>
                         <!-- 색상 수정 -->
                        <select id="time" name="time"
                            class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#05D182] transition bg-white cursor-pointer"
                            required>
                            <!-- JavaScript로 옵션 추가 -->
                        </select>
                    </div>

                    <!-- 인원수 선택 (드롭다운) -->
                    <div>
                        <label for="people" class="block text-sm font-medium text-gray-700 mb-1 transition-colors">인원수</label>
                         <!-- 색상 수정 -->
                        <select id="people" name="people"
                            class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#05D182] transition bg-white cursor-pointer"
                            required>
                            <!-- JavaScript로 옵션 추가 -->
                        </select>
                    </div>

                    <!-- 태그 토글 (단일 선택) -->
                    <div>
                        <span class="block text-sm font-medium text-gray-700 mb-2">태그</span>
                        <div id="tags-toggle-group" class="flex flex-wrap gap-2">
                        </div>
                    </div>

                    <!-- 폼 버튼 -->
                    <div class="flex justify-end space-x-4 pt-4">
                        <button type="button" id="close-modal-btn"
                            class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-lg transition-colors">취소</button>
                         <!-- 색상 수정 -->
                        <button type="submit"
                            class="bg-[#05D182] hover:bg-[#04A868] text-white font-bold py-2 px-6 rounded-lg transition-colors">포스팅</button>
                    </div>
                </form>
            </div>
        </div>

        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const openModalBtn = document.getElementById('open-modal-btn');
                const modalOverlay = document.getElementById('modal-overlay');
                const modalContent = document.getElementById('modal-content');
                const closeModalBtn = document.getElementById('close-modal-btn');
                const closeModalBtnX = document.getElementById('close-modal-btn-x');
                const postForm = document.getElementById('post-form');
                const timeSelect = document.getElementById('time');
                const peopleSelect = document.getElementById('people');
                const categoryRadios = document.querySelectorAll('input[name="category"]');
                const urlInput = document.getElementById('url');
                const urlLabel = document.querySelector('label[for="url"]');
                const peopleLabel = document.querySelector('label[for="people"]');
                const tagsToggleGroup = document.getElementById('tags-toggle-group');

                const tagData = {
                    '공동구매': ['욕실용품', '식료품', '뷰티', '가전', '그외'],
                    '공동배달': ['한식', '중식', '양식', '야식', '그외']
                };

                function setupSelectWithOptions(selectElement, defaultText, maxNumber, unit) {
                    selectElement.innerHTML = '';
                    const defaultOption = document.createElement('option');
                    defaultOption.value = "";
                    defaultOption.textContent = defaultText;
                    defaultOption.disabled = true;
                    defaultOption.selected = true;
                    selectElement.appendChild(defaultOption);

                    for (let i = 1; i <= maxNumber; i++) {
                        const option = document.createElement('option');
                        option.value = i;
                        option.textContent = `${i} ${unit}`;
                        selectElement.appendChild(option);
                    }
                }
                
                setupSelectWithOptions(timeSelect, "시간을 선택하세요", 24, "시간");
                setupSelectWithOptions(peopleSelect, "인원수를 선택하세요", 10, "명");

                // --- 색상 수정 ---
                const selectedClass = ['bg-[#05D182]', 'text-white'];
                const unselectedClass = ['bg-gray-100', 'text-gray-600'];
                
                const updateTagButtons = (category) => {
                    const tags = tagData[category] || [];
                    tagsToggleGroup.innerHTML = ''; 
                    tags.forEach(tag => {
                        const button = document.createElement('button');
                        button.type = 'button';
                        button.dataset.group = 'tags';
                        button.dataset.value = tag;
                        button.className = 'toggle-btn bg-gray-100 text-gray-600 font-semibold py-1 px-3 rounded-full cursor-pointer transition-colors hover:bg-gray-200';
                        button.textContent = `#${tag}`;
                        tagsToggleGroup.appendChild(button);
                    });
                };

                const updateFormFields = (category) => {
                    if (category === '공동배달') {
                        urlInput.disabled = true;
                        peopleSelect.disabled = true;
                        urlInput.required = false;
                        peopleSelect.required = false;
                        urlInput.value = '';
                        peopleSelect.value = '';
                        
                        // 비활성화 시 적절한 색상으로 설정
                        urlInput.classList.add('bg-gray-200', 'cursor-not-allowed', 'border-gray-200');
                        peopleSelect.classList.add('bg-gray-200', 'cursor-not-allowed', 'border-gray-200');
                        urlLabel.classList.add('text-gray-400');
                        peopleLabel.classList.add('text-gray-400');
                    } else { 
                        urlInput.disabled = false;
                        peopleSelect.disabled = false;
                        urlInput.required = true;
                        peopleSelect.required = true;

                        // 활성화 시 원래 스타일로 복원
                        urlInput.classList.remove('bg-gray-200', 'cursor-not-allowed', 'border-gray-200');
                        peopleSelect.classList.remove('bg-gray-200', 'cursor-not-allowed', 'border-gray-200');
                        urlLabel.classList.remove('text-gray-400');
                        peopleLabel.classList.remove('text-gray-400');
                    }
                    updateTagButtons(category);
                };

                const openModal = () => {
                    modalOverlay.classList.remove('hidden');
                    const currentCategory = document.querySelector('input[name="category"]:checked').value;
                    updateFormFields(currentCategory);
                    setTimeout(() => {
                        modalOverlay.classList.add('opacity-100');
                        modalContent.classList.remove('scale-95', 'opacity-0');
                        modalContent.classList.add('scale-100', 'opacity-100');
                    }, 10);
                };

                const closeModal = () => {
                    modalContent.classList.remove('scale-100', 'opacity-100');
                    modalContent.classList.add('scale-95', 'opacity-0');
                    modalOverlay.classList.remove('opacity-100');
                    setTimeout(() => {
                        modalOverlay.classList.add('hidden');
                    }, 300);
                };

                openModalBtn.addEventListener('click', openModal);
                closeModalBtn.addEventListener('click', closeModal);
                closeModalBtnX.addEventListener('click', closeModal);

                modalOverlay.addEventListener('click', (event) => {
                    if (event.target === modalOverlay) {
                        closeModal();
                    }
                });

                categoryRadios.forEach(radio => {
                    radio.addEventListener('change', (e) => {
                        updateFormFields(e.target.value);
                    });
                });

                tagsToggleGroup.addEventListener('click', (e) => {
                    const selectedBtn = e.target.closest('.toggle-btn');
                    if (!selectedBtn) return;

                    const isAlreadySelected = selectedBtn.classList.contains(selectedClass[0]);

                    tagsToggleGroup.querySelectorAll('.toggle-btn').forEach(btn => {
                        btn.classList.remove(...selectedClass);
                        btn.classList.add(...unselectedClass);
                    });

                    if (!isAlreadySelected) {
                        selectedBtn.classList.add(...selectedClass);
                        selectedBtn.classList.remove(...unselectedClass);
                    }
                });

                postForm.addEventListener('submit', (e) => {
                    e.preventDefault();

                    const selectedTag = document.querySelector('#tags-toggle-group .bg-\\[\\#05D182\\]');
                    
                    if (!selectedTag) {
                        alert('태그를 선택해주세요.');
                        return;
                    }

                    if (!postForm.checkValidity()) {
                        postForm.reportValidity();
                        return;
                    }

                    const formData = new FormData(postForm);
                    const postData = Object.fromEntries(formData.entries());
                    postData.tag = selectedTag.dataset.value;

                    console.log('--- 제출된 포스트 데이터 ---');
                    console.log(postData);

                    alert('포스트가 성공적으로 제출되었습니다! (콘솔 확인)');
                    closeModal();
                    postForm.reset();
                    
                    updateFormFields('공동구매'); 
                    
                    setupSelectWithOptions(timeSelect, "시간을 선택하세요", 24, "시간");
                    setupSelectWithOptions(peopleSelect, "인원수를 선택하세요", 10, "명");
                });
            });
        </script>

</body>
</html>

